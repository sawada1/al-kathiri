{"version":3,"file":"maintenance-5d2bc3d3.js","sources":["../../../../pages/maintenance.vue"],"sourcesContent":["<template>\r\n    <div>\r\n         <div class=\"container textBooked\">\r\n          <h3 :data-app=\"$t('HAPPY TO HELP YOU')\">{{ $t('BOOK YOUR MAINTENANCE APPOINTMENT') }}</h3>\r\n          <p>\r\n          Lorem ipsum dolor sit amet\r\n           consectetur adipisicing elit. Quos laboriosam asperiores,\r\n            iusto modi sapiente ut beatae qui! Quos aspernatur accusantium vel, \r\n          perferendis enim ipsam praesentium corporis ab quam eius. Quaerat.\r\n          Lorem ipsum dolor sit amet\r\n           consectetur adipisicing elit. Quos laboriosam asperiores,\r\n            iusto modi sapiente ut beatae qui! Quos aspernatur accusantium vel, \r\n          perferendis enim ipsam praesentium corporis ab quam eius. Quaerat.\r\n          </p>\r\n         </div>\r\n         <div class=\"container maintenance\">\r\n          <div class=\"row gap-4 justify-content-around\">\r\n           <div class=\"col-12 col-xl-7 col-lg-7 col-md-6\">\r\n            <form action=\"\" @submit.prevent>\r\n              <div class=\"inp\">\r\n               <label for=\"\"> {{ $t('full name') }}</label>\r\n               <input type=\"text\" v-model=\"mainObj.name\" :placeholder=\"$t('write your name..')\">\r\n          <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"nameError\">{{ nameError }}</span>\r\n\r\n              </div>\r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('email') }}</label>\r\n               <input type=\"email\" v-model=\"mainObj.email\" placeholder=\"example@mail.com..\">\r\n           <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"emailError\">{{ emailError }}</span>\r\n\r\n              </div>\r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('phone number') }}</label>\r\n               <input type=\"text\" v-model=\"mainObj.phone\" placeholder=\"05xxxxxxxx.....\">\r\n           <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"phoneError\">{{ phoneError }}</span>\r\n         \r\n              </div>\r\n           \r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('What is your car’s model year?') }}</label>\r\n               <input type=\"number\" v-model=\"mainObj.model_year\" min=\"1900\" max=\"2100\" step=\"1\" >\r\n           <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"modelYearError\">{{ modelYearError }}</span>\r\n       \r\n              </div>\r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('What is your car’s Brand?') }}</label>\r\n               <select  name=\"\" id=\"\" v-model=\"mainObj.brand_id\">\r\n                 <option :value=\"null\" disabled>{{ $t('Select Brand...') }}</option>\r\n                 <option v-for=\"brand in mainBrands\" :value=\"brand.id\">{{ brand.name }}</option>\r\n               </select>\r\n             <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"brandError\">{{ brandError }}</span>\r\n \r\n              </div>\r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('Which car model are you booking for?') }}</label>\r\n               <select name=\"\" id=\"\" v-model=\"mainObj.model_id\">\r\n               <option :value=\"null\" disabled>{{ $t('Select Model...') }}</option>\r\n                 <option v-if=\"mainObj.brand_id\" v-for=\"model,index in mainBrands[mainObj.brand_id - 1].models\" :value=\"model.id\">{{ model.name }}</option>\r\n               </select>\r\n          <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"modelError\">{{ modelError }}</span>\r\n \r\n              </div>\r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('Choose a city and branch for your service') }}</label>\r\n               <div class=\"d-flex gap-3\">\r\n               <div class=\"d-flex flex-column w-50\">\r\n                <select  name=\"\" id=\"\" class=\"w-100\" v-model=\"mainObj.city_id\">\r\n                 <option :value=\"null\" disabled>{{ $t('Select city...') }}</option>\r\n                 <option v-for=\"city in maincities\" :value=\"city.id\">{{ city.name }}</option>\r\n               </select>\r\n            <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"cityError\">{{ cityError }}</span>   \r\n               </div>\r\n               <div class=\"d-flex flex-column w-50\">\r\n                 <select name=\"\" id=\"\" class=\"w-100\" v-model=\"mainObj.branch_id\">\r\n                  <option :value=\"null\" disabled>{{ $t('Select branch...') }}</option>\r\n                 <option v-if=\"mainObj.city_id\" v-for=\"branch in  maincities[mainObj.city_id - 1].branches\" :value=\"branch.id\">{{ branch.name }}</option>\r\n               </select>\r\n              <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"branchError\">{{ branchError }}</span>\r\n   \r\n               </div>\r\n                \r\n             \r\n               </div>\r\n             \r\n              </div>\r\n              <div class=\"inp\">\r\n               <label for=\"\">{{ $t('Please add any extra information about your appointment request') }}</label>\r\n              <textarea style=\"resize:none;\" v-model=\"mainObj.description\" rows=\"\" cols=\"\" :placeholder=\"$t('write your message here')\"></textarea>\r\n              <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"descError\">{{descError }}</span>\r\n\r\n              </div>\r\n             \r\n            </form>\r\n           </div> \r\n           <div class=\"col-12 col-xl-4 col-lg-4 col-md-4 d-flex align-items-center gap-5 flex-column\">\r\n            <div id=\"inline_cal\">\r\n             </div>\r\n            \r\n             <div class=\"time\">\r\n               <h3>{{ $t('time') }}</h3>\r\n               <div class=\"d-flex align-items-center justify-content-center\">\r\n                 <div v-if=\"spinner\" class=\"spinner-border\" role=\"status\">\r\n              </div>\r\n               </div>\r\n              \r\n                <div class=\"timesec\">\r\n                    <span v-for=\"item,index in times\" @click=\"activeTime = index + 1,  item.available? mainObj.time = item.value : null\" :class=\"{'disabled': item.available==false,'choose':activeTime == index+1}\">{{ item.time }}</span>\r\n                </div>\r\n                \r\n             </div>\r\n                         <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\"timeError\">{{ timeError }}</span>\r\n             <div class=\"check d-flex align-items-center gap-3\">\r\n            <input id=\"checkTerms\" type=\"checkbox\" value=\"1\" v-model=\"mainObj.terms_and_privacy\">\r\n             <label for=\"checkTerms\"> {{ $t('I have read and unconditionally agree to the') }} <span type=\"button\" data-bs-toggle=\"modal\" data-bs-target=\"#termsModal\">{{ $t('Term And Conditions') }}</span>  {{ $t('and') }} <span type=\"button\" data-bs-toggle=\"modal\" data-bs-target=\"#privacyModal\">{{ $t('Privacy Policy') }}</span> </label>                \r\n             </div>\r\n            <span class=\"errorMessage text-danger fw-bold fs-5 my-2\"  v-if=\" terms_and_privacyError\">{{ terms_and_privacyError }}</span>\r\n             <button :disabled=\"spinnerBtn\" @click=\"sendAppointment()\" class=\"w-100 d-flex align-items-center justify-content-center gap-4\">\r\n            <span>{{ $t('submit') }}</span> \r\n               <div v-if=\"spinnerBtn\"  class=\"spinner-border text-light\" role=\"status\">\r\n               </div>\r\n             </button>\r\n\r\n           </div> \r\n          </div>\r\n         </div>\r\n      \r\n          <TermsModal/>\r\n         <privacyModal/>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport Swal from 'sweetalert2/dist/sweetalert2.js'\r\nimport 'sweetalert2/src/sweetalert2.scss'\r\nimport axios from 'axios';\r\n    const {locale} = useI18n();\r\nlet mainDate = ref(null);\r\nlet activeTime = ref(1);\r\nlet spinner = ref(true);\r\n    let currentLang = ref(locale);\r\n     const router = useRouter()\r\nconst url = getUrl();\r\nlet  appointmentData = await axios.get(`${url}/make-appointment-form-data`);\r\n\r\nconsole.log(appointmentData.data);\r\nlet mainBrands = ref(appointmentData.data.brands);\r\nlet maincities = ref(appointmentData.data.cities);\r\nlet daysOf = ref(appointmentData.data.days_of);\r\nconst daysOfWeek = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];\r\nlet finalDaysOf = ref([]);\r\nconst functionDaysOf = () => {\r\n  for (let i = 0; i < daysOf.value.length; i++){\r\n    finalDaysOf.value.push(daysOfWeek.indexOf(daysOf.value[i]));\r\n  }\r\n}\r\nfunctionDaysOf();\r\nconsole.log(finalDaysOf.value);\r\nlet times = ref([]);\r\nconst calender = () => {\r\n  if (process.client) {\r\n    rome(inline_cal,{\r\n      time: false,\r\n         dateValidator: function (d) {\r\n    return !finalDaysOf.value.includes(moment(d).day());\r\n  }, \r\n        \r\n    });\r\n    let lastSelectedDate = null;\r\n\r\n    let days = document.querySelectorAll('.rd-day-body');\r\n    days.forEach((ele) => {\r\n      ele.addEventListener('click', () => {\r\n          setTimeout(async () => {\r\n            mainDate.value = rome(inline_cal).getDateString();\r\n            if (lastSelectedDate != mainDate.value)\r\n            {\r\n              lastSelectedDate = mainDate.value;\r\n              let { data: allDates } = await useFetch(`${url}/time-slots?date=${mainDate.value}`);\r\n              times.value = allDates.value;\r\n              console.log(times.value);\r\n              mainObj.value.date = mainDate.value;\r\n              spinner.value = false;\r\n            }\r\n          }, 100);\r\n        })\r\n    })\r\n\r\n     document.querySelector('.rd-day-body.rd-day-selected').click();\r\n    \r\n  }\r\n\r\n}\r\nlet mainObj = ref({\r\n  name: null,\r\n  phone: null,\r\n  branch_id: null,\r\n  brand_id: null,\r\n  city_id: null,\r\n  model_id: null,\r\n  model_year:2023,\r\n  date: null,\r\n  description: null,\r\n  email: null,\r\n  time: null,\r\n  terms_and_privacy:null,\r\n  \r\n});\r\n\r\nlet phoneError = ref(null);\r\nlet nameError = ref(null);\r\nlet branchError = ref(null);\r\nlet brandError = ref(null);\r\nlet cityError = ref(null);\r\nlet modelError = ref(null);\r\nlet dateError = ref(null);\r\nlet descError = ref(null);\r\nlet emailError = ref(null);\r\nlet timeError = ref(null);\r\nlet terms_and_privacyError = ref(null);\r\nlet modelYearError = ref(null);\r\nlet spinnerBtn = ref(false);\r\n\r\nconst sendAppointment = async () => {\r\n  // start loading disable btn\r\n    spinnerBtn.value = true;\r\n   let result = fetch(`${url}/make-appointment`, {\r\n      method: 'post',\r\n       headers: {\r\n      'Accept': 'application/json',\r\n      'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify( mainObj.value),\r\n   }).then((response) => response.json())\r\n     .then((json) => {\r\n      // remove loading enable btn\r\n        spinnerBtn.value = false;\r\n       console.log(json);\r\n     \r\n       if (json.message) {\r\n               \r\n         phoneError.value = json.errors.phone == undefined ? null : json.errors.phone[0]; \r\n         nameError.value = json.errors.name == undefined ? null : json.errors.name[0]; \r\n         emailError.value = json.errors.email == undefined ? null : json.errors.email[0]; \r\n         branchError.value = json.errors.branch_id == undefined ? null : json.errors.branch_id[0]; \r\n         brandError.value = json.errors.brand_id == undefined ? null : json.errors.brand_id[0]; \r\n         cityError.value = json.errors.city_id == undefined ? null : json.errors.city_id[0]; \r\n         modelError.value = json.errors.model_id == undefined ? null : json.errors.model_id[0]; \r\n         dateError.value = json.errors.date == undefined ? null : json.errors.date[0]; \r\n         descError.value = json.errors.description == undefined ? null : json.errors.description[0]; \r\n         timeError.value = json.errors.time == undefined ? null : json.errors.time[0]; \r\n         terms_and_privacyError.value = json.errors.terms_and_privacy == undefined ? null : json.errors.terms_and_privacy[0]; \r\n         modelYearError.value = json.errors.model_year == undefined ? null : json.errors.model_year[0]; \r\n\r\n      } else {\r\n        //mainObj.value = '';\r\n          Swal.fire(\r\n          'success',\r\n          `${json}`,\r\n          'success'\r\n        );\r\n           let city = maincities.value[mainObj.value.city_id - 1].name;\r\n         let branch = maincities.value[mainObj.value.city_id - 1].branches[mainObj.value.city_id - 1].name;\r\n            const queryParams = {\r\n        id: mainObj.value.brand_id,\r\n        date: mainObj.value.date,\r\n        time: mainObj.value.time,\r\n        branch: branch,\r\n        city: city,\r\n         }\r\n    \r\n      const url = currentLang.value + '/booked'\r\n      router.push({ path:`/${url}` , query: queryParams })\r\n         spinnerBtn.value = false;\r\n        console.log(mainObj.value);\r\n       \r\n         spinnerBtn.value = false;\r\n        console.log(mainObj.value);\r\n      \r\n      }\r\n    \r\n     \r\n\r\n      \r\n    });\r\n}\r\n\r\n\r\n   useHead({\r\n  title: currentLang.value == 'ar' ? 'احجز موعد صيانتك / الكثيري للسيارات' : 'alkathiri motors / BOOK YOUR MAINTENANCE APPOINTMENT'\r\n});\r\n\r\nonMounted(async () => {\r\n  calender();\r\n})\r\n\r\n\r\n\r\n\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\r\n\r\n\r\n</style>"],"names":["_withAsyncContext"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuII,UAAM,EAAC,OAAM,IAAI;AACN,QAAI,IAAI;AACvB,QAAI,aAAa,IAAI,CAAC;AACtB,QAAI,UAAU,IAAI,IAAI;AAClB,QAAI,cAAc,IAAI,MAAM;AACZ,cAAW;AAC/B,UAAM,MAAM,OAAM;AAClB,QAAK,mBAAwB,CAAA,QAAA,SAAA,IAAAA,iBAAA,MAAA,MAAM,IAAI,GAAG,gCAAgC,CAAA;AAE1E,YAAQ,IAAI,gBAAgB,IAAI;AAChC,QAAI,aAAa,IAAI,gBAAgB,KAAK,MAAM;AAChD,QAAI,aAAa,IAAI,gBAAgB,KAAK,MAAM;AAChD,QAAI,SAAS,IAAI,gBAAgB,KAAK,OAAO;AAC7C,UAAM,aAAa,CAAC,UAAU,UAAU,WAAW,aAAa,YAAY,UAAU,UAAU;AAChG,QAAI,cAAc,IAAI,CAAA,CAAE;AACxB,UAAM,iBAAiB,MAAM;AAC3B,eAAS,IAAI,GAAG,IAAI,OAAO,MAAM,QAAQ,KAAI;AAC3C,oBAAY,MAAM,KAAK,WAAW,QAAQ,OAAO,MAAM,CAAC,CAAC,CAAC;AAAA,MAC3D;AAAA,IACH;AACA;AACA,YAAQ,IAAI,YAAY,KAAK;AAC7B,QAAI,QAAQ,IAAI,CAAA,CAAE;AAmClB,QAAI,UAAU,IAAI;AAAA,MAChB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,WAAW;AAAA,MACX,UAAU;AAAA,MACV,SAAS;AAAA,MACT,UAAU;AAAA,MACV,YAAW;AAAA,MACX,MAAM;AAAA,MACN,aAAa;AAAA,MACb,OAAO;AAAA,MACP,MAAM;AAAA,MACN,mBAAkB;AAAA,IAEpB,CAAC;AAED,QAAI,aAAa,IAAI,IAAI;AACzB,QAAI,YAAY,IAAI,IAAI;AACxB,QAAI,cAAc,IAAI,IAAI;AAC1B,QAAI,aAAa,IAAI,IAAI;AACzB,QAAI,YAAY,IAAI,IAAI;AACxB,QAAI,aAAa,IAAI,IAAI;AACT,QAAI,IAAI;AACxB,QAAI,YAAY,IAAI,IAAI;AACxB,QAAI,aAAa,IAAI,IAAI;AACzB,QAAI,YAAY,IAAI,IAAI;AACxB,QAAI,yBAAyB,IAAI,IAAI;AACrC,QAAI,iBAAiB,IAAI,IAAI;AAC7B,QAAI,aAAa,IAAI,KAAK;AAmEvB,YAAQ;AAAA,MACT,OAAO,YAAY,SAAS,OAAO,wCAAwC;AAAA,IAC7E,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}